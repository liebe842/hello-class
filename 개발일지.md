# 학급 관리 시스템 개발일지

## 2025-10-14

### 1. 학생 대시보드 UI 전면 개편
레퍼런스 디자인을 참고하여 학생 대시보드를 현대적이고 직관적인 인터페이스로 개선

#### 주요 변경사항

**1. 사이드바 내비게이션 추가** (`components/StudentSidebar.tsx`)
- 보라색 그라데이션 배경의 고정 사이드바
- 6개 핵심 메뉴 구성:
  - 🏠 대시보드
  - 🎯 퀴즈
  - 📝 과제
  - 📊 통계
  - 🏆 리더보드
  - 🏅 배지
- 모바일 반응형 디자인 (햄버거 메뉴)
- 하단에 학생 프로필 표시

**2. 대시보드 레이아웃 재구성**
- 배경: 보라-핑크 그라데이션 → 밝은 회색 (`bg-gray-50`)
- 상단 헤더: 제거 → "Hello, [이름] 👋" 인사말로 대체
- 포인트 표시: 우측 상단으로 이동, 독립적인 카드 형태
- 메인 콘텐츠: 사이드바 옆 (`flex-1 lg:ml-64`)

**3. 오늘의 정보 섹션 신규 추가**
실시간 데이터를 대시보드에서 바로 확인 가능하도록 개선

- **오늘 수업 카드** (`/student/timetable`)
  - 오늘 요일의 시간표 표시 (최대 3개 + 더보기)
  - Firestore `timetable` 컬렉션에서 실시간 조회
  - 클릭 시 시간표 페이지로 이동

- **다가오는 일정 카드** (`/student/school-schedule`)
  - 오늘부터 7일 이내의 학사일정 표시 (최대 3개)
  - 진행 중인 일정 포함
  - 클릭 시 학사일정 페이지로 이동

- **미제출 과제 카드** (`/student/assignments`)
  - 제출하지 않은 과제 목록 표시 (마감일 순)
  - 과제명 + 마감일 표시
  - 클릭 시 과제 페이지로 이동

- **빠른 메뉴 카드**
  - 급식, 칭찬, 목표 바로가기
  - 3x1 그리드 레이아웃

**4. 메뉴 카드 스타일 변경**
- 기존: 진한 그라데이션 배경 + 흰색 텍스트
- 변경: 파스텔 배경 + 테두리 + 어두운 텍스트
- 예시: `bg-purple-50 border-2 border-purple-200`
- hover 효과 강화

#### 기술적 구현

**데이터 Fetching 로직** (`app/student/dashboard/page.tsx`)
```typescript
// 여러 데이터를 한 번에 불러오기
const fetchAllData = async () => {
  // 1. 출석 데이터
  // 2. 학사일정 (오늘 + 7일)
  // 3. 시간표 (오늘 요일)
  // 4. 과제 (미제출 + 마감일 순)
};
```

**상태 관리**
```typescript
const [todaySchedule, setTodaySchedule] = useState<any[]>([]);
const [todayMeal, setTodayMeal] = useState<any>(null);
const [todayClasses, setTodayClasses] = useState<string[]>([]);
const [assignments, setAssignments] = useState<any[]>([]);
```

**요일 계산**
```typescript
const dayOfWeek = ['일', '월', '화', '수', '목', '금', '토'][new Date().getDay()];
// 시간표 키: "월-1", "화-2" 형식으로 조회
```

### 2. 관리자 사이드바 링크 수정
404 에러가 발생하던 메뉴 링크들을 실제 존재하는 페이지로 수정

#### 수정된 링크
| 메뉴명 | 이전 경로 | 수정된 경로 |
|--------|----------|------------|
| 퀴즈 & 목표 | `/admin/quiz-goals` | `/admin/quiz-topics` |
| 포인트 & 상점 | `/admin/points-shop` | `/admin/points/overview` |
| 칭찬 관리 | `/admin/praises` | `/admin/praise-list` |
| 설정 | `/admin/settings` | `/admin/class-config` |

### 3. 과제 제출 Ctrl+V 붙여넣기 개선
모달이 열리면 자동으로 전역 붙여넣기 이벤트를 감지하도록 개선

**구현 방법** (`app/student/assignments/page.tsx`)
```typescript
useEffect(() => {
  if (!showSubmitModal) return;

  const handleGlobalPaste = (e: ClipboardEvent) => {
    const items = e.clipboardData?.items;
    // 이미지 감지 및 자동 업로드
  };

  document.addEventListener('paste', handleGlobalPaste);
  return () => {
    document.removeEventListener('paste', handleGlobalPaste);
  };
}, [showSubmitModal]);
```

**개선 효과**
- 모달 열리자마자 Ctrl+V 가능
- 특정 요소 클릭 불필요
- 화면 캡처 후 바로 붙여넣기 가능

### 4. 디자인 통일성 분석 및 절충안 적용

#### 설계 결정
- **관리자**: 심플한 흰색 배경 + 블루 통일
- **학생**: 밝은 회색 배경 + 파스텔 다색상
- **공통**: 레이아웃 구조, 카드 스타일, 타이포그래피
- **차별화**: 색상, 이모지 사용, 분위기

#### 통일성 점수: 85/100
- ✅ 배경: 유사 (흰색 vs 밝은 회색)
- ✅ 카드: 동일한 shadow, border-radius
- ✅ 레이아웃: 사이드바 + 메인 구조 통일
- ⚠️ 색상: 관리자 블루 vs 학생 다색상 (의도된 차이)

### 5. 파일 변경 목록
- 📝 `components/StudentSidebar.tsx` (신규 생성)
- 📝 `app/student/dashboard/page.tsx` (전면 수정)
- 📝 `components/AdminSidebar.tsx` (링크 수정)
- 📝 `app/student/assignments/page.tsx` (붙여넣기 개선)

### 6. 다음 작업 예정
- 급식 정보 API 연동 테스트
- 학생 사이드바 활성화 상태 개선
- 대시보드 로딩 상태 최적화

---

## 2025-01-14

### 1. 수업 관리 페이지 학사일정 데이터 로딩 수정
- **문제**: 수업 관리 페이지의 학사일정 탭에서 데이터가 빈 배열로 표시됨
- **원인**: Firestore 컬렉션 이름 불일치 (`schoolSchedule` vs `schoolSchedules`)
- **해결**:
  - `app/admin/classes/page.tsx`에서 컬렉션 이름을 `schoolSchedules`로 수정
  - 9개의 학사일정 데이터가 정상적으로 표시됨

### 2. 관리자 페이지 UI 디자인 통일화
전체 관리자 페이지의 디자인을 통일된 스타일로 변경하여 일관성 있는 사용자 경험 제공

#### 통일된 디자인 패턴
1. **레이아웃 구조**:
   - 기존: `<header>` + `<main className="container mx-auto">` 구조
   - 변경: `<div className="p-8">` 단일 구조로 단순화
   - 사이드바(`AdminSidebar`)는 `app/admin/layout.tsx`에서 전역 관리

2. **헤더 영역**:
   - 기존: 컬러풀한 상단 헤더 (파란색, 보라색, 초록색 등)
   - 변경: 페이지 내 텍스트 헤더로 통일
   ```tsx
   <div className="mb-8">
     <h1 className="text-3xl font-bold text-gray-800 mb-2">[페이지 제목]</h1>
     <p className="text-gray-600">[페이지 설명]</p>
   </div>
   ```

3. **컬러 스킴**:
   - 기존: 각 페이지마다 다른 색상 (파란색, 보라색, 초록색, 빨간색 등)
   - 변경: 전체 블루 컬러로 통일 (`bg-blue-500`, `hover:bg-blue-600`)
   - 예외: 위험한 작업(삭제)은 빨간색 유지

4. **버튼 스타일**:
   - 기존: `px-6 py-3`, 이모지 포함 ("+ 등록", "📥 다운로드")
   - 변경: `px-4 py-2`, 이모지 제거 ("등록", "다운로드")

5. **타이포그래피**:
   - h1: `text-3xl font-bold text-gray-800`
   - h2: `text-xl font-bold text-gray-800` (기존 `text-2xl`에서 축소)
   - 설명 텍스트: `text-gray-600`

#### 수정된 페이지 목록
1. **학생 관리** (`app/admin/students/page.tsx`)
   - 파란색 헤더 제거
   - 버튼 이모지 제거
   - 블루 컬러로 통일

2. **과제 관리** (`app/admin/assignments/page.tsx`)
   - 보라색 헤더 제거
   - 보라색 accent를 블루로 변경
   - 제출 방식 선택 버튼 블루로 통일

3. **퀴즈 & 목표** (`app/admin/quiz-topics/page.tsx`)
   - 보라색 테마를 블루로 변경
   - 주제 배지, 체크박스 등 모든 accent 블루로 통일

4. **시간표 편집** (`app/admin/timetable/page.tsx`)
   - 파란색 헤더 제거
   - 초록색 저장 버튼을 블루로 변경
   - 이모지 제거 (📋, 📄, 📚)

5. **학사일정 관리** (`app/admin/school-schedule/page.tsx`)
   - 파란색 헤더 제거
   - 초록색, 보라색 버튼을 블루로 통일
   - CSV 업로드 관련 UI accent 블루로 변경

6. **학급 정보 설정** (`app/admin/class-config/page.tsx`)
   - 새로 생성된 페이지
   - 처음부터 통일된 디자인 패턴 적용

7. **상점 아이템 관리** (`app/admin/shop/page.tsx`)
   - 보라색 테마를 블루로 변경
   - 카테고리 배지 블루로 통일

8. **포인트 지급/차감** (`app/admin/points/grant/page.tsx`)
   - 버튼 이모지 제거 (➕, ➖)
   - 블루 컬러로 통일

9. **포인트 현황** (`app/admin/points/overview/page.tsx`)
   - 초록색, 보라색 통계 카드를 블루로 변경
   - 초기화 버튼 이모지 제거 (🔄)

10. **쿠폰 관리** (`app/admin/coupons/page.tsx`)
    - 필터 버튼 색상 통일 (회색, 노란색, 초록색, 빨간색 → 모두 블루)
    - 승인 버튼 블루로 변경

#### 기술적 변경사항
- **컴포넌트 구조 단순화**: 불필요한 wrapper 제거로 렌더링 성능 개선
- **색상 일관성**: 모든 인터랙티브 요소에 블루 계열 사용 (`blue-50`, `blue-100`, `blue-500`, `blue-600`, `blue-700`)
- **접근성 향상**: focus ring 색상 통일 (`focus:ring-blue-500`)
- **유지보수성**: 통일된 패턴으로 향후 수정 및 확장 용이

### 3. 다음 작업 예정
- 게임 관리 페이지 디자인 통일
- 설정 페이지 디자인 통일
- 학생용 페이지 디자인 검토 및 개선

---

## 2025-10-15

### 1. 학생 대시보드 미제출 과제 필터링 개선
**문제**: 마감일이 오늘인 과제가 미제출 과제 목록에 표시되지 않음

**원인**: 날짜 비교 로직에서 오늘 00:00:00과 마감일을 비교하여 오늘 마감 과제가 필터링됨

**해결**:
```typescript
// 기존: 마감일이 지나지 않은 것만 표시
const now = new Date();
now.setHours(0, 0, 0, 0);
const dueDate = new Date(a.dueDate);
dueDate.setHours(23, 59, 59, 999);
return !submittedIds.includes(a.id) && dueDate >= now;

// 변경: 제출한 것만 제외, 마감일 관계없이 모두 표시
const pendingAssignments = assignmentsData
  .filter(a => !submittedIds.includes(a.id))
  .sort((a, b) => a.dueDate.getTime() - b.dueDate.getTime());
```

**추가 개선 - 마감일 강조 표시**:
- 🔥 **오늘 마감**: 노란색 배경 + "(오늘 마감)" 텍스트
- ⚠️ **기한 초과**: 빨간색 배경 + "(기한 초과)" 텍스트
- 일반: 흰색 배경

**파일**: `app/student/dashboard/page.tsx:162-174, 541-570`

### 2. 학생 페이지 레이아웃 구조 개선 - 사이드바 고정

**문제**: 학생 페이지는 페이지 전환 시 전체가 새로 로드되고 사이드바도 재렌더링됨 (관리자는 사이드바 고정)

**해결**: 관리자와 동일한 레이아웃 구조 적용
- `app/student/layout.tsx` 생성
- 모든 학생 페이지에서 `<StudentSidebar>` 렌더링 코드 제거
- 레이아웃 레벨에서 사이드바 관리

**구현**:
```typescript
// app/student/layout.tsx
export default function StudentLayout({ children }) {
  return (
    <div className="flex min-h-screen bg-gray-50">
      <StudentSidebar />
      <main className="flex-1 lg:ml-64">
        {children}
      </main>
    </div>
  );
}
```

**효과**:
- 페이지 전환 시 사이드바 유지, 콘텐츠만 변경
- 성능 향상 (사이드바 재렌더링 불필요)
- 관리자와 동일한 사용자 경험

**파일**: `app/student/layout.tsx` (신규), `app/student/dashboard/page.tsx`

### 3. 학생 사이드바 메뉴 개선

**칭찬 메뉴 통합**:
- "칭찬하기" + "받은 칭찬" → "칭찬" 하나로 통합
- href: `/student/praise-list`
- 이유: 받은 칭찬 페이지에 이미 칭찬하기 버튼 존재

**hover 스타일 개선**:
- 기존: `hover:bg-white/10` (흰색 배경 투명도 10%)
- 변경: `hover:bg-white hover:text-purple-700` (흰색 배경 + 보라색 글씨)
- 효과: 글씨 가독성 향상

**파일**: `components/StudentSidebar.tsx:22-31, 86-89`

### 4. 대시보드 상단 헤더 통합 - 한 줄 레이아웃

**기존 구조** (2개 섹션):
1. 인사말 + 포인트/로그아웃
2. 학생 정보 카드 + 출석 버튼

**변경 구조** (1개 카드):
```
┌─────────────────────────────────────────────────┐
│ Hello, 학생 👋  |  💎 Point  📸 출석  로그아웃 │
└─────────────────────────────────────────────────┘
```

**주요 변경**:
- 프로필 정보(학년/반/번호) 제거
- 홈 버튼 제거
- 모든 요소를 한 줄에 배치
- 공간 절약 및 깔끔한 디자인

**파일**: `app/student/dashboard/page.tsx:363-433`

### 5. 대시보드 하단 레이아웃 재구성

**과제 이름 변경**:
- "미제출 과제" → "제출해야 할 과제"

**레이아웃 재구성**:
```
기존:
[출석현황] [최근감정] [출석사진]
[출석기록 (2칸)]  [나의목표]

변경:
[출석기록 (전체 한 줄, 사진 컬럼 포함)]
[나의목표]  [최근감정]
```

**출석 기록 테이블에 사진 컬럼 추가**:
- 날짜 | 시간 | **사진** | 감정
- 썸네일 크기: 48x48px

**파일**: `app/student/dashboard/page.tsx:507-666`

### 6. 모든 학생 페이지 스타일 통일 (13개 페이지)

**통일된 디자인 패턴**:

1. **레이아웃**:
   ```tsx
   <div className="p-8">
     <div className="mb-6">
       <h1 className="text-3xl font-bold text-gray-800">[제목]</h1>
       <p className="text-gray-600 text-sm">[설명]</p>
     </div>
     <main>
       {/* 콘텐츠 */}
     </main>
   </div>
   ```

2. **로딩 상태**:
   ```tsx
   <div className="flex items-center justify-center p-8">
     <div className="text-gray-800 text-2xl">로딩 중...</div>
   </div>
   ```

3. **제거된 요소**:
   - 그라데이션 배경 (`bg-gradient-to-br from-purple-400 to-pink-500`)
   - 컬러풀한 헤더 (`<header className="bg-purple-600">`)
   - "대시보드로" 버튼
   - max-width 제약 (`max-w-3xl mx-auto`)

**적용된 페이지 목록**:
1. ✅ dashboard (대시보드)
2. ✅ assignments (과제)
3. ✅ quiz-topics (퀴즈 주제)
4. ✅ badges (배지)
5. ✅ meal (급식)
6. ✅ points (포인트)
7. ✅ timetable (시간표)
8. ✅ school-schedule (학사일정)
9. ✅ praise (칭찬하기)
10. ✅ praise-list (받은 칭찬)
11. ✅ goals (나의 목표)
12. ✅ leaderboard (리더보드)
13. ✅ statistics (통계)
14. ✅ coupons (쿠폰)

**통일성 달성**:
- ✅ 사이드바 레이아웃 일관성
- ✅ 배경색 통일 (`bg-gray-50`)
- ✅ 타이틀 스타일 통일
- ✅ 로딩 상태 통일
- ✅ 카드 디자인 통일

### 7. 커밋 내역 (총 9개)

1. `fix: 미제출 과제 필터링 및 마감일 강조 표시 개선` (960e9fc)
2. `feat: 학생 페이지 레이아웃 구조 개선 - 사이드바 고정` (591a72b)
3. `fix: 학생 사이드바 칭찬 메뉴 통합 및 hover 스타일 개선` (7c107fa)
4. `feat: 대시보드 상단 헤더 통합 - 한 줄 레이아웃` (5316b0e)
5. `feat: 대시보드 하단 레이아웃 개선 및 과제 이름 변경` (2daef7d)
6. `style: 학생 페이지 스타일 통일 - assignments, quiz-topics` (59a5301)
7. `style: 학생 페이지 스타일 통일 (배지, 급식, 포인트, 시간표, 학사일정)` (eb66437)
8. `style: praise 관련 페이지 스타일 통일` (4cee64d)
9. `fix: goals, leaderboard, statistics, coupons 페이지 스타일 통일` (eddb012)
10. `fix: statistics, leaderboard 페이지 헤더 스타일 수정` (8d345e2)
11. `fix: 칭찬 페이지 max-width 제거 및 레이아웃 통일` (996ea72)

### 8. 다음 작업 예정
- quiz-topics 하위 페이지 스타일 통일 검토
- 모바일 반응형 디자인 테스트 및 개선
- 성능 최적화 (데이터 Fetching 로직 개선)
